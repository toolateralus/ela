
  
// implement defer.
// this should be really easy to transpile to a c++ RAII struct with a lambda.
defer {
  ...
}

defer STMT;

defer allocator.free(ptr);

// maybe ish like this?
#ifdef DEBUG {
  @on_return(fn (v) {
    assert(v == 100);
  });
}

defer {
  
  
  println("scope exited");
}
